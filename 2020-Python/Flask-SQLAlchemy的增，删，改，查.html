<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title> | zhang35's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">zhang35's Blog</h1><a id="logo" href="/.">zhang35's Blog</a><p class="description">日积月累</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 主页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"></h1><div class="post-meta">2020-10-16<span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4,900</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 23</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>作者：Dozing<br>链接：<a href="https://www.jianshu.com/p/b729e84fae4f" target="_blank" rel="noopener">https://www.jianshu.com/p/b729e84fae4f</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h3 id="Flask-SQLAlchemy的使用："><a href="#Flask-SQLAlchemy的使用：" class="headerlink" title="Flask-SQLAlchemy的使用："></a>Flask-SQLAlchemy的使用：</h3><p><strong>ORM的好处：可以让我们操作数据库跟操作对象是一样的，非常方便，因为一个表就抽象成一个类，一条数据就抽象成该类的一个对象</strong></p>
<p>1.初始化和设置数据库配置信息</p>
<ul>
<li><p>使用flask_sqlalchemy中的SQLAlchemy进行初始化：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">db = SQLAlchemy(app) <span class="comment"># 通过类`SQLAlchemy`来连接数据库</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置配置信息：在<code>config.py</code>文件中添加以下的配置信息：</p>
</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DB_URI = <span class="string">'mysql+mysqldb://&#123;&#125;:&#123;&#125;@&#123;&#125;/&#123;&#125;.format(USERNAME，PASSWORD，HOSTNAME，PORT，DATABASE)'</span></span><br><span class="line"><span class="comment"># 创建数据库引擎</span></span><br><span class="line">engine = create_engine(DB_URI)</span><br></pre></td></tr></table></figure>
<p>  首先从sqlalchemy中导入<code>create_engine</code>,用这个函数来创建引擎，然后用<code>engine.connect()</code>来连接数据库，其中一个比较重要的点是，通过create_engine函数的时候，需要传递一个满足某种<strong>格式</strong>的字符串，对这个字符串的格式来进行解释：</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dialect+driver:<span class="comment">//username:password@host:port/database</span></span><br></pre></td></tr></table></figure>
<p>  dialect是数据库的实现，比如MySQL,PostgreSQL,SQLite,并且转换为小写，driver是python对应的驱动，如果不指定，会选择默认的驱动，比如MySQL的默认驱动是Mysqldb,username是数据库的用户名，password是连接数据库的密码，host是连接数据的域名，port是数据库监听的端口号，database是连接哪个数据库的名字。</p>
<ul>
<li>在主<code>app</code>文件中，添加配置文件：</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db = SQLAlchemy(app)</span><br></pre></td></tr></table></figure>
<ul>
<li>测试，看有没有问题：</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.create_all()</span><br></pre></td></tr></table></figure>
<p>  如果没有报错，说明配置没有问题，如果有错误，可以根据错误进行修改</p>
<p><strong>Python语言不像Java, C,C++会有<code>main()</code>函数，Python是脚本语言，只会由上往下执行。</strong></p>
<h3 id="Flask-SQLAlchemy的使用"><a href="#Flask-SQLAlchemy的使用" class="headerlink" title="Flask-SQLAlchemy的使用"></a>Flask-SQLAlchemy的使用</h3><ol>
<li>初始化和设置数据库配置信息</li>
</ol>
<ul>
<li>使用flask_sqlalchemy中的SQLAlchemy经行初始化：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">db = SQLAlchemy(app)</span><br></pre></td></tr></table></figure>
<ol>
<li><p>设置配置信息：<code>config.py</code>文件中添加配置信息</p>
</li>
<li><p>在主<code>app</code>文件中，添加配置文件：</p>
</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db = SQLAlchemy(app)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>做测试，看有没有问题</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.create_all()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">  id = db.Column(db.Integer)</span><br></pre></td></tr></table></figure>
<h3 id="使用Flask-SQLAlchemy创建模型与表的映射："><a href="#使用Flask-SQLAlchemy创建模型与表的映射：" class="headerlink" title="使用Flask-SQLAlchemy创建模型与表的映射："></a>使用Flask-SQLAlchemy创建模型与表的映射：</h3><ol>
<li>模型需要继承自<code>db.Model</code>,然后需要映射到表中的属性，必须写成<code>db.Column</code>的数据类型。</li>
<li>数据类型：<ul>
<li><code>db.Integer</code>代表的是整形.</li>
<li><code>db.String</code>代表的是<code>varchar</code>,需要指定最长的长度.</li>
<li><code>db.Text</code>代表的是<code>text</code>.</li>
</ul>
</li>
<li>其他参数：<ul>
<li><code>primary_key</code>:代表的是将这个字段设置为主键。</li>
<li><code>autoincrement</code>:代表的是这个主键为自增长的。</li>
<li><code>nullable</code>:代表的是这个字段是否为空，默认可以为空，可以将这个值设置为<code>False</code>,在数据库中，这个值就不能为空了。</li>
</ul>
</li>
<li>最后需要调用<code>db.create_all</code>来将模型真正地创建到数据库中。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'article'</span> <span class="comment">#如果不指定表名，会默认以这个类名的小写为表名</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line">    content = db.Column(db.Text,nullable = <span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'index'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Flask-SQLAlchemy的增，删，改，查"><a href="#Flask-SQLAlchemy的增，删，改，查" class="headerlink" title="Flask-SQLAlchemy的增，删，改，查"></a>Flask-SQLAlchemy的增，删，改，查</h3><ol>
<li>增：</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增加：</span></span><br><span class="line"> article1 = Article(title = <span class="string">u'aaa'</span>,content = <span class="string">u'bbb'</span>)</span><br><span class="line"> db.session.add(article1)</span><br><span class="line"> <span class="comment"># 事务</span></span><br><span class="line"> db.session.commit()</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>查：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># select * from article where article.title = 'aaa';</span></span><br><span class="line">article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>).first()</span><br><span class="line">print(<span class="string">'title:%s'</span> % article1.title)</span><br><span class="line">print(<span class="string">'content:%s'</span> % article1.content)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># And操作</span></span><br><span class="line">article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>, Article.author == <span class="string">'bbb'</span>).first()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等价于</span></span><br><span class="line">article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>).filter(Article.author == <span class="string">'bbb'</span>).first()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="3">
<li>改：</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改：</span></span><br><span class="line"> <span class="comment"># 1.先把你要更改的数据查找出来</span></span><br><span class="line"> article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>).first()</span><br><span class="line"> <span class="comment"># 2.把这条数据，你需要修改的地方进行修改</span></span><br><span class="line"> article1.title = <span class="string">'New title'</span></span><br><span class="line"> <span class="comment"># 3.做事物的提交</span></span><br><span class="line"> db.session.commit()</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>删：</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删：</span></span><br><span class="line"> <span class="comment"># 1.把需要删除的数据查找出来</span></span><br><span class="line"> article1 = Article.query.filter(Article.title == <span class="string">'New title'</span>).first()</span><br><span class="line"> <span class="comment"># 2.把这条数据删除掉</span></span><br><span class="line"> db.session.delete(article1)</span><br><span class="line"> <span class="comment"># 3.做事物的提交</span></span><br><span class="line"> db.session.commit()</span><br></pre></td></tr></table></figure>
<h3 id="Flask-Script的介绍与安装"><a href="#Flask-Script的介绍与安装" class="headerlink" title="Flask-Script的介绍与安装"></a>Flask-Script的介绍与安装</h3><ol>
<li><code>Flask-Script</code>的作用是可以通过命令行的形式来操作Flask.例如通过命令跑一个开发版本的服务器、设置数据库、定时任务等。</li>
<li>如果直接在主<code>manager.py</code>中写命令，那么在终端就只需要<code>python manager.py command_name</code>就可以了。</li>
<li>如果把一些命令集中在一个文件中，那么在终端就需要输入一个父命令，比如<code>python manager.py db init</code></li>
<li>例子：flask_script_demo.py 和manager.py</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flask_script_demo.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello_world'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主manager.py</span></span><br><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager</span><br><span class="line"><span class="keyword">from</span> flask_script_demo <span class="keyword">import</span> app</span><br><span class="line"><span class="keyword">from</span> db_script <span class="keyword">import</span> DBmanager</span><br><span class="line"></span><br><span class="line">manager = Manager(app)</span><br><span class="line"></span><br><span class="line"><span class="meta">@manager.command</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runserver</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'服务器跑起来了'</span>)</span><br><span class="line"></span><br><span class="line">manager.add_command(<span class="string">'db'</span>,DBmanager)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    manager.run()</span><br></pre></td></tr></table></figure>
<ol>
<li>有子命令的例子：db_script.py</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager</span><br><span class="line"></span><br><span class="line">DBmanager = Manager() <span class="comment"># 这个为什么不是Manager(app)。因为这个不是主文件，所以不需要在Manager()里面写入'app'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@DBmanager.command</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'数据库初始化完成'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@DBmanager.command</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">migrate</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'数据表重新迁移成功'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这个没有下面的代码是因为这个不是主的manager.py。它只是子的文件，所以不需要有下面的代码。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">if __name__ == '__main__':</span></span><br><span class="line"><span class="string">    manager.run()</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>有关Flask-Script还是有很多的不理解,例如代码当中的解释器<a href="mailto:`@DBmanager.command" target="_blank" rel="noopener">`@DBmanager.command</a>`这个可以Flask-Script的官网。<a href="https://flask-script.readthedocs.io/en/latest/" target="_blank" rel="noopener">Flask-Script</a></p>
<h3 id="分开models和解决循环引用"><a href="#分开models和解决循环引用" class="headerlink" title="分开models和解决循环引用"></a>分开models和解决循环引用</h3><ol>
<li><p>分开Models的目的：是为了让代码更加方便地管理。</p>
</li>
<li><p>什么是循环引用？</p>
<p><strong>[循环引用] 当一个单元格内的公式直接或间接地应用了这个公式本身所在的单元格时，就称为循环引用。</strong></p>
<p>为什么会报错？因为结果还没出来，却又要去调用它。所以会报错！<br> 假设有如下的文件结构：</p>
</li>
</ol>
   <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">models_sep</span><span class="selector-class">.py</span> </span><br><span class="line"><span class="selector-tag">models</span><span class="selector-class">.py</span></span><br></pre></td></tr></table></figure>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># models_sep.py </span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Article</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello_world'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># models.py </span></span><br><span class="line"><span class="keyword">from</span> models_sep <span class="keyword">import</span> db </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'article'</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<p>上面的代码会造成一个循环引用：</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/2459618-9e5ac8143f149b5d.png?imageMogr2/auto-orient/strip|imageView2/2/w/442/format/webp" alt="img"></p>
<p>循环引用</p>
<p>主文件app引入models文件中的Article.但models文件要引入app中的db,才可以生成，做成了循环引用。</p>
<ol>
<li>如何解决循环引用：把<code>db</code>放在一个单独的文件中，切断循环引用的线条就可以<br> 假设有如下的文件结构：</li>
</ol>
   <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">app</span><span class="selector-class">.py</span> </span><br><span class="line"><span class="selector-tag">exts</span><span class="selector-class">.py</span> </span><br><span class="line"><span class="selector-tag">models</span><span class="selector-class">.py</span></span><br></pre></td></tr></table></figure>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py </span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Article</span><br><span class="line"><span class="keyword">from</span> exts <span class="keyword">import</span> db</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db.init_app(app) <span class="comment"># init_app()可以用来解决循环引用的问题</span></span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  app.run(debug = <span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># exts.py </span></span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line">db = SQLAlchemy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># models.py </span></span><br><span class="line"><span class="keyword">from</span> exts <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">  __tablename__ = <span class="string">'article'</span></span><br><span class="line">  id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">  title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Flask-SQLAlchemy的外键约束"><a href="#Flask-SQLAlchemy的外键约束" class="headerlink" title="Flask-SQLAlchemy的外键约束"></a>Flask-SQLAlchemy的外键约束</h3><ol>
<li>外键：</li>
</ol>
   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line"> __tablename__ = <span class="string">'article'</span></span><br><span class="line"> id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line"> title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line"> content = db.Column(db.Text,nullable = <span class="keyword">False</span>)</span><br><span class="line"> author_id = db.Column(db.Integer,db.ForeignKey(<span class="string">'user.id'</span>)) <span class="comment"># user这个是表的名字，而不是类的名字。注意</span></span><br><span class="line"> author = db.relationship(<span class="string">'User'</span>,backref = db.backref(<span class="string">'articles'</span>)) <span class="comment"># User这个是类的名字，注意</span></span><br><span class="line">                                                                   <span class="comment"># relations：会在Article表中寻找外键‘user.id’然后关联到User表</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">author = db.relationship(&apos;User&apos;,backref = db.backref(&apos;articles&apos;))</span><br></pre></td></tr></table></figure>
<p>解释：</p>
<ul>
<li>给<code>Article</code>这个模型添加一个<code>author</code>属性，可以访问这篇文章的作者的数据，像访问普通模型一样。</li>
<li><code>backref</code>是定义反向引用的，可以通过<code>User.articles</code>访问这个模型所写的所有文章</li>
</ul>
</li>
</ol>
<p><em>这里有一个知识点，当<code>db.create_all()</code>运行了后，数据库的表已经创建好了。若要再对表(类)修改，添加外键，关系等。将不会生效。因为表，已经在数据库中创建好了。</em><br> 例子代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户表</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'user'</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文章表</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'article'</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line">    content = db.Column(db.Text,nullable = <span class="keyword">False</span>)</span><br><span class="line">    author_id = db.Column(db.Integer,db.ForeignKey(<span class="string">'user.id'</span>)) <span class="comment"># user这个是表的名字，而不是类的名字。注意</span></span><br><span class="line">    author = db.relationship(<span class="string">'User'</span>,backref = db.backref(<span class="string">'articles'</span>)) <span class="comment"># User这个是类的名字，注意</span></span><br><span class="line">                                                                      <span class="comment"># relations：会在Article表中寻找外键‘user.id’然后关联到User表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#想要添加一篇文章，因为文章必须依赖用户而存在，所以首先的话，先添加一个用户</span></span><br><span class="line">    <span class="comment">#user1 = User(username = 'zhiliaoketang')</span></span><br><span class="line">    <span class="comment">#db.session.add(user1)</span></span><br><span class="line">    <span class="comment">#db.session.commit()</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#article1 = Article(title = 'aaa',content = 'This is an Article',author_id=1)</span></span><br><span class="line">    <span class="comment">#db.session.add(article1)</span></span><br><span class="line">    <span class="comment">#db.session.commit()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#article = Article.query.filter(Article.title == u'aaa').first()</span></span><br><span class="line">    <span class="comment">#author_id = article.author_id</span></span><br><span class="line">    <span class="comment">#user = User.query.filter(User.id == author_id).first()</span></span><br><span class="line">    <span class="comment">#print("username:%s" %(user.username))</span></span><br><span class="line">    <span class="comment">#return 'Hello World'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#article = Article(title = 'aaa',content = 'This is an Article')</span></span><br><span class="line">    <span class="comment">#article = Article(title = 'bbb',content = 'This is an Article2')</span></span><br><span class="line">    <span class="comment">#article.author = User.query.filter(User.id == 1).first()</span></span><br><span class="line">    <span class="comment">#db.session.add(article) </span></span><br><span class="line">    <span class="comment">#db.session.commit()</span></span><br><span class="line"></span><br><span class="line">    article = Article.query.filter(Article.content == <span class="string">'This is an Article2'</span>).first()</span><br><span class="line">    print(<span class="string">"author is %s"</span> %(article.author.username))</span><br><span class="line">    user = User.query.filter(User.id == <span class="number">1</span>).first()</span><br><span class="line">    print(<span class="string">"The Articles are:"</span>)</span><br><span class="line">    <span class="keyword">for</span> arti <span class="keyword">in</span> user.articles:</span><br><span class="line">        print(<span class="string">'--------'</span>)</span><br><span class="line">        print(arti.title)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>表多对多的关系：</li>
</ol>
<ul>
<li><p>多对多的关系，需要通过一个中间表进行关联。</p>
</li>
<li><p>中间表，不能通过<code>class</code>的方式实现，只能通过<code>db.Table</code>的方式实现</p>
</li>
<li><p>设置关联：<br> <code>tags = db.relationship(&#39;Tag&#39;,secondary = article_tag,backref = db.backref(&#39;articles&#39;))</code>需要使用一个关键字参数<code>secondary=中间表</code></p>
</li>
<li><p>数据的添加与访问：</p>
<ul>
<li>数据添加：</li>
</ul>
</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">article1 = Article(title = <span class="string">'aaa'</span>)</span><br><span class="line">article2 = Article(title = <span class="string">'bbb'</span>)</span><br><span class="line"></span><br><span class="line">tag1 = Tag(name = <span class="string">'999'</span>)</span><br><span class="line">tag2 = Tag(name = <span class="string">'888'</span>)</span><br><span class="line"></span><br><span class="line">article1.tags.<span class="built_in">append</span>(tag1) # 留意可以用<span class="built_in">append</span>()来添加数据</span><br><span class="line">article1.tags.<span class="built_in">append</span>(tag2)</span><br><span class="line">article2.tags.<span class="built_in">append</span>(tag1)</span><br><span class="line">article2.tags.<span class="built_in">append</span>(tag2)</span><br><span class="line"></span><br><span class="line">db.session.add(article1)</span><br><span class="line">db.session.add(article2)</span><br><span class="line"></span><br><span class="line">db.session.add(tag1)</span><br><span class="line">db.session.add(tag2)</span><br><span class="line"></span><br><span class="line">db.session.commit()</span><br><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- 数据访问：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>python </span><br><span class="line">article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>).first()</span><br><span class="line">tags = article1.tags</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> tag in tags:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'---------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'Tag: %s'</span> %(tag.name))</span><br><span class="line"></span><br><span class="line">tag1 = Tag.query.filter(Tag.name == <span class="string">'999'</span>).first()</span><br><span class="line">articles = tag1.articles</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> article in articles:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'********'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'article: %s'</span> %(article.title))</span><br><span class="line"><span class="string">``</span><span class="string">`</span></span><br></pre></td></tr></table></figure>
<p>例子代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line">article_tag = db.Table(<span class="string">'article_tag'</span>,</span><br><span class="line">              db.Column(<span class="string">'article_id'</span>,db.Integer,db.ForeignKey(<span class="string">'article.id'</span>),primary_key = <span class="keyword">True</span>),</span><br><span class="line">              db.Column(<span class="string">'tag_id'</span>,db.Integer,db.ForeignKey(<span class="string">'tag.id'</span>),primary_key = <span class="keyword">True</span>),</span><br><span class="line">              )</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'article'</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line">    tags = db.relationship(<span class="string">'Tag'</span>,secondary = article_tag,backref = db.backref(<span class="string">'articles'</span>))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tag</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'tag'</span></span><br><span class="line">    id = db.Column(db.Integer,primary_key = <span class="keyword">True</span>,autoincrement = <span class="keyword">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">100</span>),nullable = <span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">''' article1 = Article(title = 'aaa')</span></span><br><span class="line"><span class="string">    article2 = Article(title = 'bbb')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    tag1 = Tag(name = '999')</span></span><br><span class="line"><span class="string">    tag2 = Tag(name = '888')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    article1.tags.append(tag1)</span></span><br><span class="line"><span class="string">    article1.tags.append(tag2)</span></span><br><span class="line"><span class="string">    article2.tags.append(tag1)</span></span><br><span class="line"><span class="string">    article2.tags.append(tag2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    db.session.add(article1)</span></span><br><span class="line"><span class="string">    db.session.add(article2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    db.session.add(tag1)</span></span><br><span class="line"><span class="string">    db.session.add(tag2)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    db.session.commit() '''</span></span><br><span class="line"></span><br><span class="line">    article1 = Article.query.filter(Article.title == <span class="string">'aaa'</span>).first()</span><br><span class="line">    tags = article1.tags</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> tag <span class="keyword">in</span> tags:</span><br><span class="line">        print(<span class="string">'---------'</span>)</span><br><span class="line">        print(<span class="string">'Tag: %s'</span> %(tag.name))</span><br><span class="line"></span><br><span class="line">    tag1 = Tag.query.filter(Tag.name == <span class="string">'999'</span>).first()</span><br><span class="line">    articles = tag1.articles</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> article <span class="keyword">in</span> articles:</span><br><span class="line">        print(<span class="string">'********'</span>)</span><br><span class="line">        print(<span class="string">'article: %s'</span> %(article.title))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Flask-Migrate的介绍与安装："><a href="#Flask-Migrate的介绍与安装：" class="headerlink" title="Flask-Migrate的介绍与安装："></a>Flask-Migrate的介绍与安装：</h3><ol>
<li><p>介绍：因为采用<code>db.create_all</code>在后期修改字段的时候，不会自动的映射到数据库中，必须删除表，然后重新运行<code>db.create_all</code>才会重新映射，这样不符合实际的工作要求。因此flask-migrate就是为了解决这个问题，它可以在每次修改模型后，可以将修改的东西映射到数据库中。</p>
</li>
<li><p>使用<code>flask_migrate</code>必须借助<code>flask_scripts</code>,这个包的<code>MigrateCommand</code>中包含了所有和数据库相关的命令。</p>
</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask_migrate</span><br></pre></td></tr></table></figure>
<p>相关的命令：</p>
<ul>
<li><code>python manager.py db init</code>:初始化一个迁移脚本的环境，只需要执行一次</li>
<li><code>python manager.py db migrate</code>:将模型生成迁移文件，只要模型更改了，就需要执行一遍这个命令</li>
<li><code>python manager.py db upgrade</code>:将迁移文件真正映射到数据库中，每次运行<code>migrate</code>命令后，记得要运行这个命令</li>
<li>注意点：需要将你想要的映射到数据库中的模型，都要导入到<code>manager.py</code>文件中，如果没有导入进去，就不会映射到数据库中。</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> exts <span class="keyword">import</span> db</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Article</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(config)</span><br><span class="line">db.init_app(app)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建一个article模型，采用models分开的方式</span></span><br><span class="line"><span class="keyword">with</span> app.app_context():  <span class="comment"># 手动将app推到app栈顶</span></span><br><span class="line">    db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello_world'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Flask-SQLAlchemy模型的理解"><a href="#Flask-SQLAlchemy模型的理解" class="headerlink" title="Flask-SQLAlchemy模型的理解"></a>Flask-SQLAlchemy模型的理解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    id = db.Column(db.Integer(), primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line">    password = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, username)</span>:</span></span><br><span class="line">        self.username = username</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"&lt;User `&#123;&#125;`&gt;"</span>.format(self.username)</span><br></pre></td></tr></table></figure>
<p>这段代码做了什么呢？实际上，我们已经得到了<code>User</code>模型，它基于一个<code>user</code>表，该表拥有3个字段。当我们继承<code>db.Model</code>时，与数据库连接和通信的工作已经自动完成了。<code>User</code>的某些类的属性值是<code>db.Column</code>类的实例，每个这样的属性都代表了数据库表里的一个字段。在<code>db.Column</code>的构造函数里，第1个参数是可选的，通过这个参数我们可以指定该属性在数据库中的字段名。如果没有指定，则SQLAlchemy会认为字段名与这个属性的名字是一样的。如果要指定这个可选参数，则可以这样写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username = db.Column(&apos;user_name&apos;, db.String(255))</span><br></pre></td></tr></table></figure>
<p>传给<code>db.Column</code>的第2个参数会告诉SQLAlchemy，应该把这个字段作为什么类型来处理。我们在书中将会用到的主要类型有:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">db.String</span><br><span class="line">db.Text</span><br><span class="line">db.Integer</span><br><span class="line">db.Float</span><br><span class="line">db.Boolean</span><br><span class="line">db.Date</span><br><span class="line">db.DateTime</span><br><span class="line">db.Time`</span><br></pre></td></tr></table></figure>
<p>每种类型的含义都很简单。<code>String</code>和<code>Text</code>类型会接收<code>Python</code>的字符串，并且把它们转为<code>varchar</code>和<code>text</code>类型的字段。<code>Integer</code>和<code>Float</code>类型则会接收<code>Python</code>的任意数值类型，把它们分别转换为对应的正确类型，再插入数据库中。<code>Boolean</code>类型会接收<code>Python</code>的布尔值转换成<code>Boolean</code>类型的字段；如果数据库不支持<code>Boolean</code>类型的字段，则<code>SQLAlchemy</code>会自动把Python的布尔值转换为0和1保存在数据库中。<code>Date</code>,<code>DateTime</code>和Time类型使用了Python的<code>datetime</code>原生包中的同名类，并把它们转换后保存到数据库中。<code>String</code>,<code>Integer</code>和<code>Float</code>类型都会接收一个额外的参数，来告诉SQLAlchemy该字段的存储长度限制。</p>
<p><code>primary_key</code>参数会告诉<code>SQLAlchemy</code>，这个字段需要做主键索引。每个<code>SQLAlchemy</code>模型类型都必须有一个主键才能正常工作。</p>
<p><code>SQLAlchemy</code>会假设你的表名就模型类型的小写版本。但是，如果你想给表起个别的名字，你可以给类添加<code>__tablename__</code>的类属性。另外，通过采用这种方式，你也可以使用在数据库中已经存在的表，只需把表名设为该属性的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'user_table_name'</span></span><br><span class="line"></span><br><span class="line">   id = db.Column(db.Integer(), primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">255</span>))</span><br><span class="line">    password = db.Column(db.String(<span class="number">255</span>))</span><br></pre></td></tr></table></figure>
<p>我们不需要定义<code>__init__</code>或<code>__repr__</code>方法，如果我们没有定义，则SQLAlchemy会自动创建<code>__init__</code>方法。你定义的所有字段名将会成为此方法所接收的关键字的参数名。</p>
<p><a href="https://blog.csdn.net/happyanger6/article/details/53947162" target="_blank" rel="noopener">参考原文</a></p>
<p>自己当初在用<code>Flask</code>来创建用户角色时，对下面的代码的代码中的`role = Role(name = r)思考了很久。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Role</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'roles'</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">64</span>), unique=<span class="keyword">True</span>)</span><br><span class="line">    default = db.Column(db.Boolean,default=<span class="keyword">False</span>,index=<span class="keyword">True</span>)</span><br><span class="line">    permissions = db.Column(db.Integer)</span><br><span class="line">    users = db.relationship(<span class="string">'User'</span>, backref=<span class="string">'role'</span>, lazy=<span class="string">'dynamic'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert_roles</span><span class="params">()</span>:</span></span><br><span class="line">        roles = &#123;</span><br><span class="line">            <span class="string">'User'</span>:[Permission.FOLLOW,Permission.COMMENT,Permission.WRITE],</span><br><span class="line">            <span class="string">'Moderator'</span>:[Permission.FOLLOW,Permission.COMMENT,Permission.WRITE,Permission.MODERATE],</span><br><span class="line">            <span class="string">'Administrator'</span>:[Permission.FOLLOW,Permission.COMMENT,Permission.WRITE,Permission.MODERATE,Permission.ADMIN]</span><br><span class="line">        &#125;</span><br><span class="line">        default_role = <span class="string">'User'</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> roles:</span><br><span class="line">            role = Role.query.filter_by(name = r).first()</span><br><span class="line">            <span class="keyword">if</span> role <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">                role = Role(name=r)</span><br><span class="line">            role.reset_permissions()</span><br><span class="line">            <span class="keyword">for</span> perm <span class="keyword">in</span> roles[r]:</span><br><span class="line">                role.add_permission(perm)</span><br><span class="line">            role.default = (role.name == default_role)</span><br><span class="line">            db.session.add(role)</span><br><span class="line">        db.session.commit()</span><br></pre></td></tr></table></figure>
<p>角色<code>Role</code>模型明明有好几个字段，为什么但一个关键字参数<code>name = r</code>就可以用来创建一个实例？知道在SQLAlchemy中，不需要定义<code>__init__</code>或<code>__repr__</code>方法，如果没有定义，则SQLAlchemy会自动创建<code>__init__</code>方法。定义过的所有字段名将会成为此方法所接收的关键字的参数名。</p>
<p>当若作为<code>__init__()</code>构造函数的参数，不是要一次性全部赋值的吗？为什么就只有’name=r’作为关键字传入就可以了？<br> 知道看到用户<code>User</code>模型中的构造模型。发现到了关键字参数<code>**kwargs</code>。一切都突然明白了。还是自己python基础不太熟悉。要找找源代码来看一看。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(UserMixin, db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'users'</span></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>)</span><br><span class="line">    email = db.Column(db.String(<span class="number">64</span>), unique=<span class="keyword">True</span>, index=<span class="keyword">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">64</span>), unique=<span class="keyword">True</span>, index=<span class="keyword">True</span>)</span><br><span class="line">    role_id = db.Column(db.Integer, db.ForeignKey(<span class="string">'roles.id'</span>))</span><br><span class="line">    password_hash = db.Column(db.String(<span class="number">128</span>))</span><br><span class="line">    confirmed = db.Column(db.Boolean,default = <span class="keyword">False</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">64</span>))</span><br><span class="line">    location = db.Column(db.String(<span class="number">64</span>))</span><br><span class="line">    about_me = db.Column(db.Text())</span><br><span class="line">    member_since = db.Column(db.DateTime(),default = datetime.utcnow)</span><br><span class="line">    last_seen = db.Column(db.DateTime(),default = datetime.utcnow)</span><br><span class="line">    avatar_hash = db.Column(db.String(<span class="number">32</span>))</span><br><span class="line">    posts = db.relationship(<span class="string">'Post'</span>,backref = <span class="string">'author'</span>,lazy = <span class="string">'dynamic'</span>)</span><br><span class="line">    followed = db.relationship(<span class="string">'Follow'</span>,</span><br><span class="line">                                foreign_keys=[Follow.follower_id],</span><br><span class="line">                                backref=db.backref(<span class="string">'follower'</span>,lazy=<span class="string">'joined'</span>),</span><br><span class="line">                                lazy=<span class="string">'dynamic'</span>,r.</span><br><span class="line">                                cascade=<span class="string">'all,delete-orphan'</span>)</span><br><span class="line">    followers = db.relationship(<span class="string">'Follow'</span>,</span><br><span class="line">                                 foreign_keys=[Follow.followed_id],</span><br><span class="line">                                 backref=db.backref(<span class="string">'followed'</span>,lazy=<span class="string">'joined'</span>),</span><br><span class="line">                                 lazy=<span class="string">'dynamic'</span>,</span><br><span class="line">                                 cascade = <span class="string">'all,delete-orphan'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,**kwargs)</span>:</span></span><br><span class="line">        super(User,self).__init__(**kwargs)</span><br><span class="line">        <span class="keyword">if</span> self.role <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.email == current_app.config[<span class="string">'FLASKY_ADMIN'</span>]:</span><br><span class="line">                self.role = Role.query.filter_by(name = <span class="string">'Administrator'</span>).first()</span><br><span class="line">            <span class="keyword">if</span> self.role <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">                self.role = Role.query.filter_by(default = <span class="keyword">True</span>).first()</span><br><span class="line">        <span class="keyword">if</span> self.email <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> self.avatar_hash <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            self.avatar_hash = self.gravatar_hash()</span><br></pre></td></tr></table></figure>
<p>还有就是对为什么在用户的<code>confirm</code>函数中，只有<code>db.session.add(self)</code><br> 而没有db.session.commit().</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def confirm(<span class="keyword">self</span>,token):</span><br><span class="line">    s = Serializer(current_app.config[<span class="string">'SECRET_KEY'</span>])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = s.loads(token)</span><br><span class="line">    except:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">if</span> data.get(<span class="string">'confirm'</span>)!=<span class="keyword">self</span>.id:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    <span class="keyword">self</span>.confirmed = <span class="keyword">True</span></span><br><span class="line">    db.session.add(<span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<p>这个这是模型，真正实现<code>db.session.commit()</code>的是在视图函数里面。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@auth</span>.route(<span class="string">'/confirm/&lt;token&gt;'</span>)</span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line">def confirm(token):</span><br><span class="line">    <span class="keyword">if</span> current_user.confirmed:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">'main.index'</span>)</span><br><span class="line">    <span class="keyword">if</span> current_user.confirm(token):</span><br><span class="line">        db.session.commit()</span><br><span class="line">        flash(<span class="string">'You have confirmed your account.Thanks'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flash(<span class="string">'The confirmation link is invalid or has expired.'</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">'main.index'</span>))</span><br></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://zhang35.github.io/2020-Python/Flask-SQLAlchemy的增，删，改，查.html" data-id="ckhmz6u02000x4kr3clyqulwu" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACrUlEQVR42u3aQXLCMAwF0N7/0u22HUj4kqyWzjxWTAiOHwvbfOnjI359fnvl9z9+9/GVPLH69PILDw8PbzD1q+FO8e5Hu7/S/Mnw8PDw1njJFPO1Nxl/Mk4yZzw8PLz34d3fn28t+WZz9V08PDy8/8i7f2S+nSQHZTw8PLx341WHu7qSxAe9pX89a8HDw8PrVJ0Ksezfvl+p7+Hh4eGNq+pJqFo9XlfHH80WDw8Pb4GXL7g9aq+0djbwxcPDwzvLq7Y0nZpEPkL10x/v8fDw8BZ4vfL8PFrtLfSj6BYPDw9vmZdvGJOoNz9kJzN8QcXDw8Nb403K9veLfhLLTopzL0bAw8PDO8rLl9pk0r3NoHdAL+94eHh4eId4yXSTgKBa8q8+dz5zPDw8vDkvWViTElQS1+YLfXXRv7wHDw8Pb4GXH5TzCW0EEHlk/OQKHh4e3gIvDyZOPbhXEhs1XeHh4eEd4lVbrM4+fnIQL/xjwMPDw/sVXq8Qlce++VaRl76ejI+Hh4e3wJuXmqrNWIX4tdV2cACJh4eHF/DyxqbJwXdycB81YOHh4eEd5U0KS6faDqrs+2cVKnt4eHh4a7xe6FA9glcxUZyBh4eHt8zrtQhUj7y9H6UXiODh4eFt8CbLfTVmTX6s6qdRdIKHh4e3zMvDgt4GcCqwKBz38fDw8JZ51V6DeaDQK6RFYQQeHh7eMi9n5PfM7+w1GRyYOh4eHt7t//RqIJvEr/Mm1EJD6tWneHh4eAu83rLba2nN76yGI/NNBQ8PD6/Kqxb+e81V1ejh/kqhhIaHh4e3xusVxqrLeg+WbFqXFjw8PLw34OVTz8tg1YNyYXw8PDy8N+ZNYtl8myk3GeDh4eGt8fJjbjUhro48Z+Ph4eFt86p/+DeK/dWD8oGaHh4eHl6H9wVly6ZLCRu1qwAAAABJRU5ErkJggg==">分享</a><div class="tags"></div><div class="post-nav"><a class="pre" href="/2020-Python/jupyter-lab.html"></a><a class="next" href="/2020-Docker/docker-offline-install.html">Centos7 离线安装Docker</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git学习笔记/">Git学习笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-Web/">Java Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo个人博客/">hexo个人博客</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/spark/">spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vba编程/">vba编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vim学习笔记/">vim学习笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/centos7/" style="font-size: 15px;">centos7</a> <a href="/tags/offline/" style="font-size: 15px;">offline</a> <a href="/tags/高效能-七个习惯/" style="font-size: 15px;">高效能 七个习惯</a> <a href="/tags/Win7/" style="font-size: 15px;">Win7</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/gitignore/" style="font-size: 15px;">.gitignore</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/bubble-sort/" style="font-size: 15px;">bubble sort</a> <a href="/tags/c/" style="font-size: 15px;">c</a> <a href="/tags/both-sides/" style="font-size: 15px;">both sides</a> <a href="/tags/PicGo/" style="font-size: 15px;">PicGo</a> <a href="/tags/Typora/" style="font-size: 15px;">Typora</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Gitee/" style="font-size: 15px;">Gitee</a> <a href="/tags/二叉树/" style="font-size: 15px;">二叉树</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/next/" style="font-size: 15px;">next</a> <a href="/tags/gitpage/" style="font-size: 15px;">gitpage</a> <a href="/tags/maupassant/" style="font-size: 15px;">maupassant</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/scala/" style="font-size: 15px;">scala</a> <a href="/tags/vim/" style="font-size: 15px;">vim</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/spark/" style="font-size: 15px;">spark</a> <a href="/tags/ppt/" style="font-size: 15px;">ppt</a> <a href="/tags/excel/" style="font-size: 15px;">excel</a> <a href="/tags/vba/" style="font-size: 15px;">vba</a> <a href="/tags/AngularJS-web/" style="font-size: 15px;">AngularJS web</a> <a href="/tags/freecodecamp/" style="font-size: 15px;">freecodecamp</a> <a href="/tags/bootstrap/" style="font-size: 15px;">bootstrap</a> <a href="/tags/java-web/" style="font-size: 15px;">java web</a> <a href="/tags/gulp/" style="font-size: 15px;">gulp</a> <a href="/tags/量化考评-web-购物车-成长曲线-评语-angular-js-gulp-bower-jade/" style="font-size: 15px;">量化考评 web 购物车 成长曲线 评语 angular.js gulp bower jade</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020-Docker/docker-mysql.html">docker搭建mysql环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Spark/pyspark-wordcount.html">Spark/pyspark-wordcount</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Spark/spark-scala-wordcount.html">Spark/spark-scala-wordcount</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Spark/pyspark-dataframe.html">Spark/pyspark-dataframe</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Python/http.html">Python/http</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Postgis/queries.html">Postgis/queries</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Python/jupyter-lab.html">Python/jupyter-lab</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Python/Flask-SQLAlchemy的增，删，改，查.html">Python/Flask-SQLAlchemy的增，删，改，查</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Docker/docker-offline-install.html">Centos7 离线安装Docker</a></li><li class="post-list-item"><a class="post-list-link" href="/2020-Docker/docker-win7-install.html">Win7安装Docker</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/zhang35" title="github/zhang35" target="_blank">github/zhang35</a><ul></ul><a href="https://blog.csdn.net/zhang35" title="zhang35的博客_CSDN" target="_blank">zhang35的博客_CSDN</a><ul></ul><a href="https://www.jianshu.com/u/6c4f283454b5" title="篮筐轰炸机5号_简书" target="_blank">篮筐轰炸机5号_简书</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">zhang35's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>